# Docker ç½‘ç»œé…ç½®æŒ‡å—

## é—®é¢˜ç°è±¡

å¦‚æœä½ åœ¨æ„å»º Docker é•œåƒæ—¶é‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š

```
failed to resolve source metadata for docker.io/...
unexpected status from HEAD request: 500 Internal Server Error
EOF
```

è¯´æ˜æ— æ³•è®¿é—® Docker Hubï¼Œéœ€è¦é…ç½®é•œåƒåŠ é€Ÿã€‚

---

## ğŸš€ å¿«é€Ÿè§£å†³ï¼ˆæ¨èï¼‰

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨å®˜æ–¹æºï¼ˆé…ç½® Docker Desktop ä»£ç†ï¼‰

**æœ€ç¨³å®šçš„æ–¹æ¡ˆ**ï¼Œé€‚åˆæœ‰ä»£ç†çš„ç”¨æˆ·ã€‚

#### æ­¥éª¤ï¼š

1. **æ‰“å¼€ Docker Desktop è®¾ç½®**
   - å³é”®æ‰˜ç›˜å›¾æ ‡ â†’ Settings

2. **é…ç½®ä»£ç†**
   - Settings â†’ Resources â†’ Proxies
   - é€‰æ‹© "Manual proxy configuration"
   - å¡«å…¥ä»£ç†åœ°å€ï¼Œä¾‹å¦‚ï¼š
     - HTTP Proxy: `http://127.0.0.1:7890`
     - HTTPS Proxy: `http://127.0.0.1:7890`

3. **åº”ç”¨å¹¶é‡å¯**
   - ç‚¹å‡» Apply & Restart

4. **é‡æ–°æ„å»º**
   ```bash
   docker-compose --profile chatglm3 up -d --build
   ```

---

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨é•œåƒåŠ é€Ÿå™¨

**æ— éœ€ä»£ç†**ï¼Œä½¿ç”¨å›½å†…é•œåƒæºã€‚

#### æ­¥éª¤ï¼š

1. **åˆ›å»ºé…ç½®æ–‡ä»¶**

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# Windows
copy .env.example .env

# Linux/Mac
cp .env.example .env
```

2. **é€‰æ‹©é•œåƒæº**

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå–æ¶ˆæ³¨é‡Šä¸€ä¸ªé•œåƒæºï¼š

```bash
# é€‰é¡¹1ï¼šå—äº¬å¤§å­¦é•œåƒï¼ˆæ¨èï¼‰
REGISTRY_MIRROR=docker.nju.edu.cn/

# é€‰é¡¹2ï¼šdockerproxyï¼ˆå¯èƒ½ä¸ç¨³å®šï¼‰
# REGISTRY_MIRROR=dockerproxy.com/

# é€‰é¡¹3ï¼šdocker.nastool.de
# REGISTRY_MIRROR=docker.nastool.de/

# é€‰é¡¹4ï¼šä½¿ç”¨å®˜æ–¹æº
# REGISTRY_MIRROR=
```

3. **é‡æ–°æ„å»º**

```bash
docker-compose --profile chatglm3 up -d --build
```

---

### æ–¹æ¡ˆ3ï¼šé…ç½® Docker Engine é•œåƒæº

**å…¨å±€é…ç½®**ï¼Œä¸€æ¬¡è®¾ç½®ï¼Œæ‰€æœ‰é¡¹ç›®ç”Ÿæ•ˆã€‚

#### æ­¥éª¤ï¼š

1. **æ‰“å¼€ Docker Desktop è®¾ç½®**
   - Settings â†’ Docker Engine

2. **æ·»åŠ é•œåƒæº**

åœ¨ JSON é…ç½®ä¸­æ·»åŠ ï¼š

```json
{
  "registry-mirrors": [
    "https://docker.nju.edu.cn",
    "https://docker.mirrors.ustc.edu.cn"
  ]
}
```

3. **åº”ç”¨å¹¶é‡å¯**

4. **é‡æ–°æ„å»º**

```bash
docker-compose --profile chatglm3 up -d --build
```

---

## ğŸ“‹ å¯ç”¨é•œåƒæºåˆ—è¡¨ï¼ˆ2026å¹´ï¼‰

| é•œåƒæº | åœ°å€ | ç¨³å®šæ€§ | å¤‡æ³¨ |
|--------|------|--------|------|
| **å—äº¬å¤§å­¦** | `docker.nju.edu.cn/` | â­â­â­â­â­ | æ¨è |
| **ä¸­ç§‘å¤§** | `docker.mirrors.ustc.edu.cn/` | â­â­â­â­ | å¯é  |
| **docker.nastool.de** | `docker.nastool.de/` | â­â­â­ | å¤‡ç”¨ |
| **dockerproxy.com** | `dockerproxy.com/` | â­â­ | ä¸ç¨³å®š |

---

## ğŸ§ª æµ‹è¯•é•œåƒæº

æµ‹è¯•é•œåƒæºæ˜¯å¦å¯ç”¨ï¼š

```bash
# æµ‹è¯•å®˜æ–¹æº
docker pull python:3.11-slim

# æµ‹è¯•å—äº¬å¤§å­¦é•œåƒ
docker pull docker.nju.edu.cn/python:3.11-slim

# æµ‹è¯•ä¸­ç§‘å¤§é•œåƒ
docker pull docker.mirrors.ustc.edu.cn/python:3.11-slim
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆä¸åœ¨ä»£ç ä¸­å†™æ­»é•œåƒæºï¼Ÿ

**A**: å› ä¸ºï¼š
1. é•œåƒæºå¯èƒ½ä¸ç¨³å®šæˆ–å¤±æ•ˆ
2. å›½å¤–ç”¨æˆ·ä¸éœ€è¦é•œåƒåŠ é€Ÿ
3. ä¸åŒç”¨æˆ·ç½‘ç»œç¯å¢ƒä¸åŒï¼Œéœ€è¦çµæ´»é…ç½®

### Q2: æˆ‘æœ‰ä»£ç†ï¼Œåº”è¯¥ç”¨å“ªä¸ªæ–¹æ¡ˆï¼Ÿ

**A**: ä½¿ç”¨**æ–¹æ¡ˆ1**ï¼ˆé…ç½® Docker Desktop ä»£ç†ï¼‰ï¼Œè¿™æ˜¯æœ€ç¨³å®šçš„ã€‚

### Q3: æˆ‘æ²¡æœ‰ä»£ç†ï¼Œåº”è¯¥ç”¨å“ªä¸ªæ–¹æ¡ˆï¼Ÿ

**A**: ä½¿ç”¨**æ–¹æ¡ˆ2**ï¼ˆ`.env` é…ç½®é•œåƒæºï¼‰ï¼Œæ¨è `docker.nju.edu.cn/`ã€‚

### Q4: æˆ‘ä¸æƒ³æ¯æ¬¡éƒ½æŒ‡å®šé•œåƒæºï¼Ÿ

**A**: ä½¿ç”¨**æ–¹æ¡ˆ3**ï¼ˆé…ç½® Docker Engineï¼‰ï¼Œå…¨å±€ç”Ÿæ•ˆã€‚

### Q5: æ‰€æœ‰é•œåƒæºéƒ½å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: è€ƒè™‘ï¼š
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. å°è¯•ä½¿ç”¨ä»£ç†
3. è”ç³»ç½‘ç»œç®¡ç†å‘˜

---

## ğŸ¯ æ¨èé…ç½®

### æœ‰ä»£ç†ç”¨æˆ·ï¼š
```
æ–¹æ¡ˆ1: Docker Desktop â†’ é…ç½®ä»£ç†
```

### æ— ä»£ç†ç”¨æˆ·ï¼ˆä¸­å›½å¤§é™†ï¼‰ï¼š
```
æ–¹æ¡ˆ2: åˆ›å»º .env æ–‡ä»¶ â†’ REGISTRY_MIRROR=docker.nju.edu.cn/
```

### å›½å¤–ç”¨æˆ·ï¼š
```
æ— éœ€é…ç½®ï¼Œç›´æ¥ä½¿ç”¨å®˜æ–¹æº
```

---

## ğŸ“ è¿˜æœ‰é—®é¢˜ï¼Ÿ

å¦‚æœä¸Šè¿°æ–¹æ¡ˆéƒ½æ— æ³•è§£å†³ï¼Œè¯·ï¼š
1. æ£€æŸ¥ Docker Desktop æ˜¯å¦æ­£å¸¸è¿è¡Œ
2. æ£€æŸ¥ç½‘ç»œè¿æ¥
3. æŸ¥çœ‹ Docker æ—¥å¿—ï¼š`docker system info`
4. æäº¤ Issue: https://github.com/conan7072/stock-agent/issues

---

**æ›´æ–°æ—¶é—´**: 2026-01-22
